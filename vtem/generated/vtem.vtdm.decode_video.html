<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">


<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    
    <title>vtem.vtdm.decode_video &mdash; Video Time Encoding and Decoding Machines 0.1.1 documentation</title>
    
    <link rel="stylesheet" href="../_static/sphinxdoc.css" type="text/css" />
    <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
    
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    '../',
        VERSION:     '0.1.1',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true
      };
    </script>
    <script type="text/javascript" src="../_static/jquery.js"></script>
    <script type="text/javascript" src="../_static/underscore.js"></script>
    <script type="text/javascript" src="../_static/doctools.js"></script>
    <link rel="top" title="Video Time Encoding and Decoding Machines 0.1.1 documentation" href="../index.html" />
    <link rel="up" title="vtem.vtdm" href="../reference_vtdm.html" /> 
  </head>
  <body>
    <div class="related">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../genindex.html" title="General Index"
             accesskey="I">index</a></li>
        <li class="right" >
          <a href="../reference_ensemble_encode.html" title="vtem.ensemble_encode"
             accesskey="N">next</a> |</li>
        <li class="right" >
          <a href="#" title="vtem.vtdm.decode_video"
             accesskey="P">previous</a> |</li>
        <li><a href="../index.html">Video Time Encoding and Decoding Machines 0.1.1 documentation</a> &raquo;</li>
          <li><a href="../reference.html" >Reference</a> &raquo;</li>
          <li><a href="../reference_vtdm.html" accesskey="U">vtem.vtdm</a> &raquo;</li> 
      </ul>
    </div> 
      <div class="sphinxsidebar">
        <div class="sphinxsidebarwrapper">
  <h3>This Page</h3>
  <ul class="this-page-menu">
    <li><a href="../_sources/generated/vtem.vtdm.decode_video.txt"
           rel="nofollow">Show Source</a></li>
  </ul>
<div id="searchbox" style="display: none">
  <h3>Quick search</h3>
    <form class="search" action="../search.html" method="get">
      <input type="text" name="q" />
      <input type="submit" value="Go" />
      <input type="hidden" name="check_keywords" value="yes" />
      <input type="hidden" name="area" value="default" />
    </form>
    <p class="searchtip" style="font-size: 90%">
    Enter search terms or a module, class or function name.
    </p>
</div>
<script type="text/javascript">$('#searchbox').show(0);</script>
        </div>
      </div> 

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body">
            
  <div class="section" id="vtem-vtdm-decode-video">
<h1>vtem.vtdm.decode_video<a class="headerlink" href="#vtem-vtdm-decode-video" title="Permalink to this headline">¶</a></h1>
<dl class="data">
<dt id="vtem.vtdm.decode_video">
<tt class="descclassname">vtem.vtdm.</tt><tt class="descname">decode_video</tt><em class="property"> = &lt;function decode_video at 0x48ef398&gt;</em><a class="headerlink" href="#vtem.vtdm.decode_video" title="Permalink to this definition">¶</a></dt>
<dd><p>Reconstruct video using VTDM with dirichlet kernel, assuming IAF neurons</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters :</th><td class="field-body"><p class="first"><strong>spikefile</strong> : string</p>
<blockquote>
<div><p>the file generated by VTEM containing spike info</p>
</div></blockquote>
<p><strong>Dswfilename</strong> : string</p>
<blockquote>
<div><p>file generated by VTDM_prep</p>
</div></blockquote>
<p><strong>dirichfilename</strong> : string</p>
<blockquote>
<div><p>file generated by VTDM_prep</p>
</div></blockquote>
<p><strong>start_time</strong> : float</p>
<blockquote>
<div><p>the starting time of the segment to reconstruct</p>
</div></blockquote>
<p><strong>end_time</strong> : float</p>
<blockquote>
<div><p>the ending time of the segment to reconstruct</p>
</div></blockquote>
<p><strong>dt</strong> : float</p>
<blockquote>
<div><p>the interval between two consecutive frames in the output</p>
</div></blockquote>
<p><strong>Mx</strong> : integer</p>
<blockquote>
<div><p>order of dirichlet space in x variable
must be the same as used in VTDM_prep</p>
</div></blockquote>
<p><strong>My</strong> : integer, optional</p>
<blockquote>
<div><p>order of dirichlet space in y variable
must be the same as used in VTDM_prep
if not specified, My = Mx</p>
</div></blockquote>
<p><strong>Mt</strong> : integer, optional</p>
<blockquote>
<div><p>order of dirichlet space in t variable
if not specified, will infer from spikefile</p>
</div></blockquote>
<p><strong>domain: list, optional</strong> :</p>
<blockquote>
<div><p>4-list or 4-tuple, [xstart, xend, ystart, yend]
the spatial domain to recover
must be the same as in VTDM_prep</p>
</div></blockquote>
<p><strong>Wx</strong> : float, optional</p>
<blockquote>
<div><p>bandwidth in x variable
if not specified, will use the info in spikefile</p>
</div></blockquote>
<p><strong>Wy</strong> : float, optional</p>
<blockquote>
<div><p>bandwidth in y variable
if not specified, will use the info in spikefile</p>
</div></blockquote>
<p><strong>Wt</strong> : float, optional</p>
<blockquote>
<div><p>bandwidth in t variable
if not specified, will use the info in spikefile</p>
</div></blockquote>
<p><strong>lamb</strong> : float, optional</p>
<blockquote>
<div><p>smoothing coefficient lambda</p>
</div></blockquote>
<p><strong>dtype</strong> : optional</p>
<blockquote>
<div><p>np.float128 or np.float64, data type of the output
If not specified, will be set to np.float64</p>
</div></blockquote>
<p><strong>stitching: bool, optional</strong> :</p>
<blockquote>
<div><p>True if the recovery algorithm should use stiching.
False otherwise.
If not specified, will be set to False.
Stiching should ideally be used only for long videos.</p>
</div></blockquote>
<p><strong>stitch_interval</strong> : integer, optional</p>
<blockquote>
<div><p>If stitching is set to True, stitch_interval
will set the individual segment lengths.
If not specified, will default to an interval
corresponding to 20 frames. If a larger video is
being decoded, this should be explicitly set to a
lower value if a single GPU is being used.</p>
</div></blockquote>
<p><strong>spatial_stitiching</strong> : bool, optional</p>
<blockquote>
<div><p>True if the recovery algorithm should use
spatial stitching. If the video is of high
resolution, should be set to true.
Spatial stiching will be diabled if the domain
of recovery is less than 96x96 pixels.
If not specified, will be set to False.</p>
</div></blockquote>
<p><strong>spatial_interval</strong> : list, optional</p>
<blockquote>
<div><p>If spatial_stiching is set to True, will determine
the domain for spatial stiching.
If not specified, will default to [96,96] pixels.</p>
</div></blockquote>
<p><strong>precompute</strong> : bool, optional</p>
<blockquote>
<div><p>If set to True, innerproducts will be calculated and
stored in an h5 file before the VTDM call.
If not specified, will default to True</p>
</div></blockquote>
<p><strong>write_blocks: bool, optional</strong> :</p>
<blockquote>
<div><p>Only used if spatial_stitching is True.
If set to True, will write the individual blocks to disc 
as well.
If not specified, will be set to False</p>
</div></blockquote>
<p><strong>output_format</strong> : integer, optional</p>
<blockquote>
<div><p>0 to write recovered video to avi file
1 to write recovered video to h5 file
Anything else to not write recovered video to disc
If not specified, will be set to 0</p>
</div></blockquote>
<p><strong>output</strong> : string, optional</p>
<blockquote>
<div><p>output filename in which the reconstructed video will be stored
If not specified, will be set to &#8220;rec&#8221;</p>
</div></blockquote>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns :</th><td class="field-body"><p class="first last"><strong>The recovered video as a numpy array</strong> :</p>
</td>
</tr>
</tbody>
</table>
<p class="rubric">Notes</p>
<p>On a single device with 3 GB memory, around 27000 spikes can be decoded.
Spatial stitching and temporal stitching can be used to recover a video
which produces more spikes than what can be decoded on single GPU. 
See Example below.</p>
<p>The coordinate system is given by the following:</p>
<div class="highlight-python"><pre>row (width / X) major

-----------------------------------------&gt; width
|   Y
|   ^--------------------&gt;
|   |--------------------&gt;
|   |--------------------&gt;
|   |--------------------&gt; X
| 
|
v
height</pre>
</div>
<p class="rubric">Examples</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">atexit</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">pycuda.driver</span> <span class="kn">as</span> <span class="nn">cuda</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">numpy</span> <span class="kn">as</span> <span class="nn">np</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">vtem</span> <span class="kn">import</span> <span class="n">vtem</span><span class="p">,</span><span class="n">vtdm</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">cuda</span><span class="o">.</span><span class="n">init</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">context1</span> <span class="o">=</span> <span class="n">cuda</span><span class="o">.</span><span class="n">Device</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span><span class="o">.</span><span class="n">make_context</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">atexit</span><span class="o">.</span><span class="n">register</span><span class="p">(</span><span class="n">cuda</span><span class="o">.</span><span class="n">Context</span><span class="o">.</span><span class="n">pop</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">vtem</span><span class="o">.</span><span class="n">VTEM_Gabor_IAF</span><span class="p">(</span><span class="s">&#39;fly_large.avi&#39;</span><span class="p">,</span> <span class="s">&#39;spikes.h5&#39;</span><span class="p">,</span> 
<span class="go">                        2*np.pi*10, h5input=False)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">vtdm</span><span class="o">.</span><span class="n">decode_video</span><span class="p">(</span><span class="s">&#39;spikes.h5&#39;</span><span class="p">,</span> <span class="s">&#39;dsw.h5&#39;</span><span class="p">,</span> <span class="s">&#39;dirich.h5&#39;</span><span class="p">,</span>
<span class="go">                      0, 1, 0.01, Mx, rnn=True, alpha=5000, steps=4000,</span>
<span class="go">                      dtype=np.float32, stitching=True, stitch_interval=0.2,</span>
<span class="go">                      spatial_stitching = True, spatial_interval = [80,80],</span>
<span class="go">                      output_format=0, write_blocks=True)</span>
</pre></div>
</div>
</dd></dl>

</div>


          </div>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="related">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../genindex.html" title="General Index"
             >index</a></li>
        <li class="right" >
          <a href="../reference_ensemble_encode.html" title="vtem.ensemble_encode"
             >next</a> |</li>
        <li class="right" >
          <a href="#" title="vtem.vtdm.decode_video"
             >previous</a> |</li>
        <li><a href="../index.html">Video Time Encoding and Decoding Machines 0.1.1 documentation</a> &raquo;</li>
          <li><a href="../reference.html" >Reference</a> &raquo;</li>
          <li><a href="../reference_vtdm.html" >vtem.vtdm</a> &raquo;</li> 
      </ul>
    </div>
    <div class="footer">
        &copy; Copyright 2013, Nikul H. Ukani, Yiyin Zhou.
      Created using <a href="http://sphinx.pocoo.org/">Sphinx</a> 1.2b1.
    </div>
  </body>
</html>